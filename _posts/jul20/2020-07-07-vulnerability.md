---
layout: post
title:  "Vulnerability"
date:   2020-07-07
categories: java
permalink: /:categories/vulnerability
---

<ol>
	<li><a href="#directoryPathTraversal">Directory (Path) Traversal</a></li>
	<li><a href="#leftoverDebugCode">Leftover Debug Code</a></li>
	<li><a href="#userEnumeration">User Enumeration</a></li>
	<li><a href="#privilegeEscalation">Privilege Escalation</a></li>
	<li><a href="#csrf">Cross-Site Request Forgery(CSRF)</a></li>
	<li><a href="#encodingHashingEncryption">Encoding vs. Hashing vs. Encryption</a></li>
	<li><a href="#passwordStorage">Password Storage</a></li>
	<li><a href="#sqlInjection">SQL Injection</a></li>
	<li><a href="#commandInjection">Command Injection</a></li>
	<li><a href="#denialOfService">Denial of Service via Unrestricted File Upload</a></li>
	<li><a href="#ssRequestFogery">Server-Side Request Forgery</a></li>
	<li><a href="#raceCondition">Race Condition</a></li>
	<li><a href="#insecureTlsValidation">Insecure TLS Validation</a></li>
</ol>

<br/>
<h3><a id="directoryPathTraversal">Directory (Path) Traversal</a></h3>
<ul>
	<li><a href="https://en.wikipedia.org/wiki/Directory_traversal_attack">What</a>: It allows illegal access to directories and files stored inside the server.</li>
	<li>How: It's possible using "../" on the address.</li>
	<li>Solution: Verify the path before to create the URI</li>
</ul>
<p style="text-align: center;"><iframe width="560" height="315" src="https://www.youtube.com/embed/nrIXfQedmng" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
<em><span style="text-decoration: underline;">References: </span></em>
<ul>
	<li><a href="https://portswigger.net/web-security/file-path-traversal#:~:text=Directory%20traversal%20(also%20known%20as,and%20sensitive%20operating%20system%20files">PortSwigger</a></li>
	<li><a href="https://en.wikipedia.org/wiki/Directory_traversal_attack">Wiki</a></li>
</ul>

<br/>
<h3><a id="leftoverDebugCode">Leftover Debug Code</a></h3>
<ul>
	<li>What: It is a back door code let by the developer to debug or test the app</li>
	<li>Solution: Create some routine to remove this kind of code.</li>
</ul>
<span style="text-decoration: underline;"><em>Reference</em></span>: <a href="https://vulncat.fortify.com/en/detail?id=desc.structural.java.j2ee_badpractices_leftover_debug_code">J2EE Bad Practices: Leftover Debug Code</a>

<br/>
<h3><a id="userEnumeration">User Enumeration</a></h3>
<ul>
	<li>What: It's a ilegal access to data/functionality from a user that can exist or not.</li>
	<li>How: It's caused by a misconfiguration by username that can exist or not.</li>
	<li>Solution: Right config of the users, take care about the response messages.</li>
</ul>
<p style="text-align: center;"><iframe width="560" height="315" src="https://www.youtube.com/embed/fP0VVzPI4jQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
<span style="text-decoration: underline;"><em>Reference</em></span>: <a href="https://www.hacksplaining.com/prevention/user-enumeration">Hacksplaining</a>

<h3><a id="privilegeEscalation">Privilege Escalation</a></h3>
It is a vulnerability in which the attacker has unauthorized access. It allows one user to create, read, update and delete the data.
<ul>
	<li><em>Horizontal Privilege Escalation: </em>The attacker act as another user.</li>
	<li><em>Vertical Privilege Escalation</em>: The user gains higher privileges.</li>
</ul>
<p style="text-align: center;"><iframe width="560" height="315" src="https://www.youtube.com/embed/7PpYavvu-6k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
<span style="text-decoration: underline;"><em>References</em></span>:
<ul>
	<li><a href="https://www.cynet.com/cyber-attacks/privilege-escalation/">Cynet</a></li>
	<li><a href="https://www.acunetix.com/blog/web-security-zone/what-is-privilege-escalation/">Acunetixis</a></li>
	<li><a href="https://blog.netwrix.com/2018/09/05/what-is-privilege-escalation/">Netwrix</a></li>
</ul>

<br/>
<h3><a id="csrf">Cross-Site Request Forgery(CSRF)</a></h3>
This vulnerability permits an attacker to force another logged-in user of the app to perform actions.

<em>References</em>: <a href="https://portswigger.net/web-security/csrf">PortSwigger</a>
<table>
<tbody>
<tr>
<td><iframe width="260" height="215" src="https://www.youtube.com/embed/m0EHlfTgGUU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></td>
<td><iframe width="260" height="215" src="https://www.youtube.com/embed/eWEgUcHPle0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></td>
</tr>
</tbody>
</table>
<h3><a id="encodingHashingEncryption">Encoding vs. Hashing vs. Encryption</a></h3>
<p style="text-align: justify;">Encoding is a technique that can be used to transform data and also to compress data to be transferred. However, the decode is an easy process given that its scheme is available. Because of that, should be avoid to be used as a secure way to transfer data.</p>
<p style="text-align: justify;">Hashing also transforms data but using the hash function. Using in security operation together with cryptographic, it can be used to ensure the integrity of data.</p>
Encryption transforms data to ensure the security of data follows some rules. Encryption should be used if data confidentiality is the goal. Neither hashing nor encoding provides enough security to keep data safe.

<span style="text-decoration: underline;">References</span>:
<ul>
	<li><a href="https://fabiana2611.github.io/java/jca">JCA - Java Cryptography Architecture</a></li>
	<li><a href="https://fabiana2611.github.io/blockchain/blockchain-int">Blockchain - Init</a></li>
</ul>

<br/>
<h3><a id="passwordStorage">Password Storage</a></h3>
<center>
<iframe width="360" height="215" src="https://www.youtube.com/embed/8ZtInClXe1Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>

<h3><a id="sqlInject">Sql Injection</a></h3>
<p style="text-align: justify;">Use PreparedStatement and not string concatenation.</p>
<pre>
#Example of sql:
' or 1='1
</pre>

<table>
<tr>
<td>
<iframe width="360" height="215" src="https://www.youtube.com/embed/OwUDCQbzFCg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</td>
<td>
<iframe width="360" height="215" src="https://www.youtube.com/embed/UMJV3OpjsoM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</td>
</tr>
</table>

<br/>
<h3><a id="commandInjection">Command Injection</a></h3>

<ul>
	<li>Avoid calling OS commands</li>
	<li>Use an API</li>
	<li>Implement a strong input validation</li>
</ul>

<table>
<tr>
<td>
<iframe width="360" height="215" src="https://www.youtube.com/embed/K9_JQke0YaA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</td>
<td>
<iframe width="360" height="215" src="https://www.youtube.com/embed/8PDDjCW5XWw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></td>
</tr>
</table>

<span style="text-decoration: underline;">References</span>:
<ul>
	<li><a href="https://portswigger.net/web-security/file-path-traversal">Portswigger</a></li>
</ul>

<br/>
<h3><a id="denialOfService">Denial of Service via Unrestricted File Upload</a></h3>

<table>
<tr>
<td>
<iframe width="360" height="215" src="https://www.youtube.com/embed/irUcyDOXvcg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</td>
<td>
<iframe width="360" height="215" src="https://www.youtube.com/embed/v4gx9vTvmt4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</td>
</tr>
</table>

You can prevent this vulnerability by:
<ul>
	<li>File type verification</li>
	<li>Restrict specific file extensions</li>
	<li>Malware prevention</li>
	<li>User authentication</li>
	<li>Store files in an external directory</li>
</ul>

<span style="text-decoration: underline;">References</span>:
<ul>
	<li><a href="https://blog.devolutions.net/2019/12/how-to-prevent-file-upload-vulnerabilities">How to Prevent File Upload Vulnerabilities</a></li>
	<li><a href="https://applicationsecurity.io/appsec-findings-database/unrestricted-file-upload/">Unrestricted File Upload</a></li>
	<li><a href="https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload">OWASP - Unrestricted File Upload</a></li>
</ul>

<br/>
<h3><a id="ssRequestFogery">Server-Side Request Forgery</a></h3>

<center>
<iframe width="360" height="215" src="https://www.youtube.com/embed/_IVjvNelzMw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>

<span style="text-decoration: underline;">References</span>:
<ul>
	<li><a href="https://portswigger.net/web-security/ssrf">PortSwigger - SSRF</a></li>
	<li><a href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">OWASP</a></li>
</ul>

<br/>
<h3><a id="raceCondition">Race Condition</a></h3>

<center>
<iframe width="360" height="215" src="https://www.youtube.com/embed/eKKc0d7kzww" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>

You can prevent by:
<ul>
	<li>The use of keywords provided by the programming language (e.g. synchronized)</li>
	<li>The use of libraries that guarantee atomicity and provide advanced lock implementations</li>
</ul>

<span style="text-decoration: underline;">References</span>:
<ul>
	<li><a href="https://resources.infosecinstitute.com/category/certifications-training/secure_coding/race-condition-vulnerabilities/#gref">Infosec</a></li>
	<li><a href="https://medium.com/swlh/hacking-banks-with-race-conditions-2f8d55b45a4b">Hacking Banks With Race Conditions</a></li>
</ul>

<br/>
<h3><a id="insecureTlsValidation">Insecure TLS Validation</a></h3>

<center>
<iframe width="360" height="215" src="https://www.youtube.com/embed/slbwCMHqCkc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>

<span style="text-decoration: underline;">References</span>:
<ul>
	<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/01-Testing_for_Weak_SSL_TLS_Ciphers_Insufficient_Transport_Layer_Protection">Testing for Weak SSL TLS Ciphers Insufficient Transport Layer Protection</a></li>
	<li><a href="https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/">TLS Security 6: Examples of TLS Vulnerabilities and Attacks</a></li>
</ul>
